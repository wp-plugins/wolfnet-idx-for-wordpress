(function(a){var T,z,F=function(){};F.prototype.createMap=function(b){var e={mapName:a(b).attr("data-wnt-map-name"),centerLat:a(b).attr("data-wnt-map-centerlat"),centerLng:a(b).attr("data-wnt-map-centerlng"),mapZoomLevel:a(b).attr("data-wnt-map-mapzoomlevel"),hasHouseView:"true"===a(b).attr("data-wnt-map-hasHouseView"),hasStreetView:"true"===a(b).attr("data-wnt-map-hasStreetView"),hasMiniMap:"true"===a(b).attr("data-wnt-map-hasMiniMap"),showScales:"true"===a(b).attr("data-wnt-map-showScales"),showZoom:"false"!==
a(b).attr("data-wnt-map-showZoom"),showView:"false"!==a(b).attr("data-wnt-map-showView"),provider:a(b).attr("data-wnt-map-provider"),mapViewType:a(b).attr("data-wnt-map-mapViewType"),mapDragType:a(b).attr("data-wnt-map-mapDragType"),allowMouseWheel:a(b).attr("data-wnt-map-allowMouseWheel"),hasStartingRect:a(b).is("[data-wnt-map-brLat]"),startingRectangle:{tlLat:a(b).attr("data-wnt-map-tlLat"),tlLng:a(b).attr("data-wnt-map-tlLng"),brLat:a(b).attr("data-wnt-map-brLat"),brLng:a(b).attr("data-wnt-map-brLng")},
persistedMapScale:a("#h_map_scale").val(),hasPOIIcon:a(b).is("[data-wnt-map-poi-icon]"),poiIcon:{icon:a(b).attr("data-wnt-map-poi-icon"),lat:a(b).attr("data-wnt-map-poi-lat"),lng:a(b).attr("data-wnt-map-poi-lng")}};e.isMovable="true"===a(b).attr("data-wnt-map-isMoveable");this.map=new U(b,e)};var U=function(b,e){var A,V,W,X,G,H,x,Y,F,fa,ga,B,C;T++;var h=this,J=T,n=i(e.mapName,"map"),u=a(b).width(),v=a(b).height(),ha=i(e.mapZoomLevel,6),ia=i(e.houseViewZoomLevel,1),D=i(e.centerLat,44.970104),E=i(e.centerLng,
-93.256915),Z=i(e.isMovable,!0),U=i(e.hasMiniMap,!1);i(e.showScales,!0);var ja=i(e.showZoom,!0),ka=i(e.showView,!0),j=i(e.provider,"bing"),la=i(e.mapViewType,"map"),s="move",O=i(e.hasStreetView,!1),K=i(e.hasHouseView,!1),P=i(e.allowMouseWheel,!1),$=!1,Q=i(e.mapquestPan,25),aa=i(e.mapquestMaxZoom,15),ba=i(e.mapquestMinZoom,3),ma=i(e.bingVerticalPan,75),na=i(e.bingHorizontalPan,100),xa=i(e.hasStartingRect,!1),R=i(e.startingRectangle,{}),oa=i(e.persistedMapScale,""),ya=i(e.hasPOIIcon,!1),ca=i(e.poiIcon,
{}),pa=s;a.browser.msie&&6==a.browser.version.substring(0,1)&&(K=!1);var o="",L="",da="",I="",M=!1,S=!1;this.getBingMapNode=function(){return k};this.getMapQuestNode=function(){return q};this.getCurrentView=function(){return o};this.getDragType=function(){return s};this.getAllowMouseWheel=function(){return P};this.getMapOrientation=function(){return I};this.isHouseViewAvailable=function(){return M};this.isStreetViewAvailable=function(){return S};this.hasStreetView=function(){return O};this.hasHouseView=
function(){return K};this.pauseDrag=function(){pa=s;s="";"move"==h.getDragType()?h.setDragMove(!1):h.setDragZoom(!1)};this.resumeDrag=function(){s=pa;"move"==h.getDragType()?h.setDragMove(!0):h.setDragZoom(!0)};this.setMapBindings=function(){A.val(g.getCenter().lat);V.val(g.getCenter().lng);W.val(g.getCurrentMapType().id);X.val(g.getBounds().lr.lat);G.val(g.getBounds().lr.lng);H.val(g.getBounds().ul.lat);x.val(g.getBounds().ul.lng);Y.val(h.getZoomLevel());A.change();V.change();W.change();X.change();
G.change();H.change();x.change();Y.change()};this.setupMouseControls=function(){var f=a.browser,b=!1,c=this;void 0!=f.msie&&8>f.version.slice(0,1)&&(b=!1);a("[data-wnt-controlContainer=][data-wnt-map-name="+n+"]").each(function(){a(this).data("controlContainer",c.controlContainer(this,{}))});a("[data-wnt-nav=][data-wnt-map-name="+n+"]").each(function(){ka&&(void 0!=B&&g.removeControl(B),B=c.navMapControl(this,{}),a(this).data("nav",B))});b&&(a("[data-wnt-mouseControlContainer=][data-wnt-map-name="+
n+"]").each(function(){a(this).data("mouseControlContainer",c.mouseControlContainer(this,{}))}),a("[data-wnt-mouseControl=][data-wnt-map-name="+n+"]").each(function(){a(this).data("mouseControl",c.mouseControl(this,{}))}));a("[data-wnt-pan=][data-wnt-map-name="+n+"]").each(function(){if(ja){C!=void 0&&g.removeControl(C);C=c.panZoomMapControl(this,{expandedZoom:a(this).attr("data-wnt-pan-expandedzoom")==="true"});a(this).data("pan",C)}});a("[data-wnt-poi][data-wnt-map-name="+n+"]").each(function(){var f=
a(this).attr("data-wnt-poi")==="mapquest"?c.mapquestFind("jsreqhandler.cfm?sname=spatial.access.mapquest.com&spath=mq&sport=80"):c.bingFind();a(this).data("poi",f);a("[data-wnt-poi-checkbox=]",this).each(function(){var b=this,c=a(this).attr("data-wnt-poi-icon"),m=a(this).val();a(b).click(function(){a(b).is(":checked")?f.add(m,c):f.remove(m)})});a("[data-wnt-poi-textbox=]",this).each(function(){var b=this,c=a(this).attr("data-wnt-poi-icon"),m=a(this).val();a(b).change(function(){f.remove(m);m=a(b).val();
f.add(m,c)})});a("[data-wnt-poi-select=]",this).each(function(){var b=this,c=a(this).attr("data-wnt-poi-icon"),m=a(this).val();a(b).change(function(){f.remove(m);m=a(b).val();f.add(m,c)})});var b=c.getSize().height,m=c.getSize().width;a("[data-wnt-poi-expand=]",this).click(function(){c.setSize(m,b*2)});a("[data-wnt-poi-collapse=]",this).click(function(){c.setSize(m,b)});a("#modernPOIExpand").click(function(){c.setSize(m,b*2)});a("#modernPOIContract").click(function(){c.setSize(m,b)});a("#modernPOIMapView").click(function(){c.setMapView()});
a("#modernPOIHybridView").click(function(){c.setHybridView()});a("#modernPOIAerialView").click(function(){c.setSatView()});a("#modernPOIStreetView").click(function(){c.setStreetView()})})};this.loadPOILibraries=function(){null!=r&&google.maps.event.trigger(r,"resize");"undefined"==eval("typeof VEMap")&&void 0==a(k).attachEvent&&this.loadBingLibrary()};this.loadBingLibrary=function(){var a=document.getElementsByTagName("head")[0],b=document.createElement("script");b.type="text/javascript";b.src="http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=6.2";
a.appendChild(b);this.isBingLibraryLoaded()};this.isBingLibraryLoaded=function(){var a=setInterval(function(){"undefined"!=eval("typeof VEMap")&&void 0!=document.getElementById(k.id).attachEvent&&(clearInterval(a),h.configureBingMap())},10)};this.configureBingMap=function(){K&&(a(k).show(),d=new VEMap(k.id),d.LoadMap(new VELatLong(D,E),ia,VEMapStyle.Birdseye),d.HideDashboard(),d.SetCenter(new VELatLong(D,E)),d.AttachEvent("onkeydown",function(a){return 40<a.keyCode||37>a.keyCode}),d.AttachEvent("onkeyup",
function(a){return 40<a.keyCode||37>a.keyCode}),d.AttachEvent("onkeypress",function(a){return 40<a.keyCode||37>a.keyCode}),d.AttachEvent("onendzoom",function(){h.onZoomEnd()}),d.AttachEvent("onobliquechange",function(){h._orientationChanged()}),window.setInterval(function(){h._houseViewClientHandler()},500),-1!=navigator.userAgent.indexOf("Firefox/3.5")&&k.addEventListener("DOMMouseScroll",function(a){a.stopPropagation();a.preventDefault();return a.cancelBubble=!1},!1),a(k).hide())};this.reset=function(){this.setCenter(D,
E,ha)};this.getMapName=function(){return n};this.setMapIsLoading=function(f){(L=f)?("zoom"==s&&a(w).css({display:"block",cursor:"progress"}),a("img").bind("mousedown",function(a){a.preventDefault()})):(a(w).css({display:"none"}),"zoom"!=s&&a("img").bind("mousedown",function(){}),a("img").bind("mousedown",function(){}))};this.setMapView=function(){null!=r&&(r.setVisible(!1),r=null);switch(j){case "mapquest":a(k).hide();a(q).show();g.setMapType("map");break;case "bing":a(k).show(),d.SetMapStyle(VEMapStyle.Road)}a(b).trigger("enableMouseControls",
[]);this._doMapSync("map")};this.setOfficeID=function(){};this.toggleMouseWheelZoom=function(){"move"==s&&!a.browser.msie&&($?(MQA.withModule("mousewheel",function(){g.enableMouseWheelZoom();g._mouseZooming=!0}),P=$=!1,this._toggleMouseControl("mouseWheelZoom",!1,!1)):(MQA.withModule("mousewheel",function(){g.enableMouseWheelZoom();g._mouseZooming=!1}),P=$=!0,this._toggleMouseControl("mouseWheelZoom",!0,!1)),a(b).trigger("mapControlChanged"))};this.setSatView=function(){null!=r&&(r.setVisible(!1),
r=null);switch(j){case "mapquest":a(k).hide();a(q).show();g.setMapType("sat");break;case "bing":a(k).show(),d.SetMapStyle(VEMapStyle.Aerial)}a(b).trigger("enableMouseControls",[]);this._doMapSync("sat")};this.setHybridView=function(){null!=r&&(r.setVisible(!1),r=null);switch(j){case "mapquest":a(k).hide();a(q).show();g.setMapType("hyb");break;case "bing":a(k).show(),d.SetMapStyle(VEMapStyle.Hybrid)}a(b).trigger("enableMouseControls",[]);this._doMapSync("hyb")};this.setStreetView=function(){if(O&&
S){a(k).hide();a(q).hide();var f={position:new google.maps.LatLng(D,E),pitch:10,zoom:1};null==r&&(r=new google.maps.StreetViewPanorama(document.getElementById("poiMap_map"),f));a(b).trigger("disableMouseControls",[]);this._doMapSync("street")}};this.setHouseView=function(){this.hasHouseView()&&M&&(a(q).hide(),null!=r&&(r.setVisible(!1),r=null),a(k).show(),"bing"===j&&d.SetMapStyle(VEMapStyle.Birdseye),a(b).trigger("disableMouseControls",[]),this._doMapSync("house"))};this.setDragMove=function(f){null==
f&&(f=!0);a("img").bind("mousedown",function(a){a.preventDefault()});s="move";g._wireDOMEvents(q);this._toggleMouseControl("dragMove",!1,f);a(w).css({display:"none"})};this.setDragZoom=function(f){void 0==f&&(f=!0);a("img").bind("mousedown",function(){});s="zoom";g._unwireDOMEvents();this._toggleMouseControl("dragZoom",!1,f)};this.setCenter=function(a,b,c){switch(j){case "mapquest":switch(o){case "house":break;case "street":break;default:g.setCenter({lat:a,lng:b}),g.setZoomLevel(Number(c)+3)}break;
case "bing":d.SetCenterAndZoom(new VELatLong(a,b),c)}};this.getCenter=function(){switch(j){case "mapquest":switch(o){case "house":var a=d.GetCenter();return{lat:a.Latitude,lng:a.Longitude};case "street":break;default:return g.getCenter()}break;case "bing":return a=d.GetCenter(),{lat:a.Latitude,lng:a.Longitude}}};this.getBounds=function(){switch(j){case "mapquest":switch(o){case "house":var a=d.GetMapView();return{ul:{lat:a.TopLeftLatLong.Latitude,lng:a.TopLeftLatLong.Longitude},lr:{lat:a.BottomRightLatLong.Latitude,
lng:a.BottomRightLatLong.Longitude}};case "street":break;default:return g.getBounds()}break;case "bing":return a=d.GetMapView(),{ul:{lat:a.TopLeftLatLong.Latitude,lng:a.TopLeftLatLong.Longitude},lr:{lat:a.BottomRightLatLong.Latitude,lng:a.BottomRightLatLong.Longitude}}}};this.getMapquestMaxZoom=function(){return aa};this.getMapquestMinZoom=function(){return ba};this.panUp=function(){switch(o){case "house":d.Pan(0,-ma);break;case "street":break;default:g.panNorth(Q)}};this.panDown=function(){switch(o){case "house":d.Pan(0,
ma);break;case "street":break;default:g.panSouth(Q)}};this.panRight=function(){switch(o){case "house":d.Pan(na,0);break;case "street":break;default:g.panEast(Q)}};this.panLeft=function(){switch(o){case "house":d.Pan(-na,0);break;case "street":break;default:g.panWest(Q)}};this.zoomIn=function(){switch(o){case "house":d.ZoomIn();break;case "street":break;default:switch(j){case "mapquest":g.setZoomLevel(g.getZoomLevel()+1);break;case "bing":d.ZoomIn()}}};this.zoomOut=function(){switch(o){case "house":d.ZoomOut();
break;case "street":break;default:switch(j){case "mapquest":g.setZoomLevel(g.getZoomLevel()-1);break;case "bing":d.ZoomOut()}}};this.zoomTo=function(a){switch(o){case "house":case "street":break;default:switch(j){case "mapquest":g.setZoomLevel(Number(a)+3);break;case "bing":d.SetZoomLevel(a)}}};this.getZoomLevel=function(){switch(o){case "house":case "street":return 1;default:switch(j){case "mapquest":return Number(g.getZoomLevel())-3;case "bing":return d.GetZoomLevel()}}};this.rotateCW=function(){if("house"==
o)switch(d.GetBirdseyeScene().GetOrientation()){case "North":d.SetBirdseyeOrientation(VEOrientation.East);break;case "South":d.SetBirdseyeOrientation(VEOrientation.West);break;case "West":d.SetBirdseyeOrientation(VEOrientation.North);break;case "East":d.SetBirdseyeOrientation(VEOrientation.South)}};this.rotateCCW=function(){if("house"==o)switch(d.GetBirdseyeScene().GetOrientation()){case "North":d.SetBirdseyeOrientation(VEOrientation.West);break;case "South":d.SetBirdseyeOrientation(VEOrientation.East);
break;case "West":d.SetBirdseyeOrientation(VEOrientation.South);break;case "East":d.SetBirdseyeOrientation(VEOrientation.North)}};this.addPoi=function(a){this.addMapPoi(a);this.addHouseViewPoi(a)};this.removePoi=function(a){this.removeMapPoi(a);this.removeHouseViewPoi(a)};this.addMapPoi=function(a){switch(j){case "mapquest":g.addShape(a.getMapquestPoi());break;case "bing":this.addHouseViewPoi(a)}};this.removeMapPoi=function(a){switch(j){case "mapquest":g.removeShape(a.getMapquestPoi());a.mapquestPoi=
null;break;case "bing":this.removeHouseViewPoi(a)}};this.addHouseViewPoi=function(a){if("house"==o||"bing"===j){try{d.AddShape(a.getBingPoi())}catch(b){}a.getBingPoi().Show()}};this.removeHouseViewPoi=function(a){("house"==o||"bing"===j)&&a.getBingPoi().Hide()};this.setSize=function(f,m){u=f;v=m;a(b).css({width:u,height:v});a(k).css({width:u,height:v});a(q).css({width:u,height:v});O&&null!=r&&google.maps.event.trigger(r,"resize");(K||"bing"==j)&&d.Resize(u,v);"mapquest"==j&&g.setSize(new MQA.Size(u,
v));a(b).trigger("shiftMouseControlContainer",[m])};this.getSize=function(){return{width:u,height:v}};this.show=function(){a(b).show()};this.hide=function(){a(b).hide()};this.doBingFind=function(a,b){"bing"===j&&d.Find(a,null,VEFindType.Businesses,null,0,10,!1,!1,!1,!1,b)};this.canZoomIn=function(){switch(o){case "house":return 2<=d.GetZoomLevel()?!1:!0;case "street":break;default:switch(j){case "mapquest":return h.getZoomLevel()>=aa?!1:!0;case "bing":return d.GetZoomLevel()>=aa?!1:!0}}};this.canZoomOut=
function(){switch(o){case "house":return 1>=d.GetZoomLevel()?!1:!0;case "street":break;default:switch(j){case "mapquest":return h.getZoomLevel()<=ba?!1:!0;case "bing":return d.GetZoomLevel()<=ba?!1:!0}}};this.zoomToRect=function(a,b,c,l){switch(j){case "mapquest":a=new MQA.LatLng(a,b);c=new MQA.LatLng(c,l);l=new MQA.RectLL;l.ul=a;l.lr=c;g.zoomToRect(l);break;case "bing":d.SetMapView([new VELatLong(a,b),new VELatLong(c,l)])}};this._doMapSync=function(f){o=f;a(b).trigger("currentView",[f]);this._orientationChanged()};
this._toggleMouseControl=function(f,m,c){a(b).trigger("toggleMouseControl",[f,m,c])};this._houseViewClientHandler=function(){d.IsBirdseyeAvailable()!=M&&(M=d.IsBirdseyeAvailable(),a(b).trigger("isHouseViewAvailable",[d.IsBirdseyeAvailable()]))};this._streetViewClientHandler=function(f){null==f?(S=!1,a(b).trigger("isStreetViewAvailable",[!1]),"undefined"!=typeof a("#modernPOIStreetView")&&a("#modernPOIStreetView").hide()):(S=!0,a(b).trigger("isStreetViewAvailable",[!0]))};this._dragZoomMouseDown=function(f){this.mouseIsDown=
!0;u=a(b).width();v=a(b).height();this.aspectRatio=v/u;a(w).css({top:"0px",left:"0px",height:v+"px",width:u+"px"});"search"==n?(this.coverOffX=parseInt(a(b).position().left),this.coverOffY=parseInt(a(b).position().top)):(this.coverOffX=parseInt(a(b).offset().left),this.coverOffY=parseInt(a(b).offset().top));a("blockDiv").innerHTML="";this.startY=f.pageY;this.startX=f.pageX;this.startX-=this.coverOffX;this.startY-=this.coverOffY;a(w).css({display:"block",cursor:"se-resize"});a(y).css({display:"block",
left:this.startX+"px",top:this.startY+"px",height:"1px",width:"1px"})};this._dragZoomMouseMove=function(f){if(this.mouseIsDown){var b=f.pageY,f=f.pageX,f=f-this.coverOffX,b=b-this.coverOffY;this.startX>f?1>f?(this.drawLeft=1,this.drawWidth=this.startX-1):(this.drawLeft=f,this.drawWidth=this.startX-f):(this.drawLeft=this.startX,this.drawWidth=f-this.startX);f=this.drawWidth*this.aspectRatio;this.drawTop=this.startY>b?0>b?1:this.startY-f:this.startY;this.drawHeight=f;a(y).css({left:this.drawLeft+"px",
top:this.drawTop+"px",width:this.drawWidth+"px",height:this.drawHeight+"px"})}};this._dragZoomMouseUp=function(a){this.mouseIsDown=!1;var b=a.pageY,a=a.pageX;this.startX+=this.coverOffX;this.startY+=this.coverOffY;this.endX=a>this.startX?this.startX+this.drawWidth:this.startX-this.drawWidth;this.endY=b>this.startY?this.startY+this.drawHeight:this.startY-this.drawHeight;b=!1;a=!0;35<Math.abs(this.endX-this.startX)&&(8>Math.abs(this.startX-this.endX)&&8>Math.abs(this.startY-this.endY)?(b=g.pixToLL(new MQA.Point(this.startX,
this.startY)),a=g.pixToLL(new MQA.Point(this.endX,this.endY))):(b=g.pixToLL(new MQA.Point(ra-sa,ta-ua)),a=g.pixToLL(new MQA.Point(va-sa,wa-ua))),this.zoomToRect(b.getLatitude(),b.getLongitude(),a.getLatitude(),a.getLongitude()),a=!1,b=!0);this._dragZoomReset(b,a)};this._dragZoomReset=function(b,m){if("zoom"==s){wa=va=ta=ra=0;if(b&&!L){var c=g.getSize().width+1,l=g.getSize().height+1,d=!0,e=a.browser;this.setMapIsLoading(!0);void 0!=e.msie&&"8"==e.version.slice(0,1)&&(d=!1);d?a(y).animate({top:"0px",
left:"0px",width:c+"px",height:l+"px",opacity:0.2,filter:"alpha(opacity=20)"},200,function(){a(y).css({display:"none",top:"0px",left:"0px",width:"0px",height:"0px",opacity:0.6,filter:"alpha(opacity=60)"});a(w).css({display:"none"})}):(a(y).css({display:"none"}),a(w).css({display:"none"}))}else c=700,void 0!=m&&m&&(c=0),a(y).fadeOut(c,function(){a(y).css({display:"none",top:"0px",left:"0px",width:"0px",height:"0px",opacity:0.6,filter:"alpha(opacity=60)"});a(w).css({display:"none"})});this.setMapIsLoading(!1);
a("img").bind("mousedown",function(a){a.preventDefault()})}};this._orientationChanged=function(){if("house"==o)switch(d.GetBirdseyeScene().GetOrientation()){case VEOrientation.North:I="n";break;case VEOrientation.South:I="s";break;case VEOrientation.West:I="w";break;case VEOrientation.East:I="e"}else I="n";a(b).trigger("mapOrientation",[I])};this.controlContainer=function(f){z++;var m=document.createElement("div");a(m).addClass("wntControlExpand").click(function(){a(b).trigger("showControls")});a(f).parent().append(m);
a(b).bind("hideControls",function(){a(f).animate({left:-400},800,function(){a(m).animate({left:0},400)})});a(b).bind("showControls",function(){a(m).animate({left:-71},400,function(){a(f).animate({left:0},800)})})};this.navMapControl=function(f){var m=this,c=z++,l=document.createElement("div");a(l).addClass("wntStreetCloseButton").click(function(){m.setMapView()}).hide();a(f.parentNode).append(l);var d=document.createElement("span");a(d).attr("id","wntNavBackground"+c).addClass("wntNavBackground");
a(f).append(d);d=document.createElement("span");a(d).attr("id","wntNavStart"+c).addClass("wntNavStart");a(f).append(d);var g=document.createElement("span");a(g).attr("id","wntNavMapView"+c).addClass("wntNavMenuItem").html("Map").click(function(){m.setMapView()});a(f).append(g);var e=document.createElement("span");a(e).attr("id","wntNavHybridView"+c).addClass("wntNavMenuItem").html("Hybrid").click(function(){m.setHybridView()});a(f).append(e);var h=document.createElement("span");a(h).attr("id","wntNavSatView"+
c).addClass("wntNavMenuItem").html("Aerial").click(function(){m.setSatView()});a(f).append(h);if(this.hasHouseView()){var t=document.createElement("span");a(t).attr("id","wntNavHouseView"+c).addClass("wntNavMenuItem").html("House View").click(function(){m.setHouseView()});a(f).append(t)}if(this.hasStreetView()){var i=document.createElement("span");a(i).attr("id","wntNavStreetView"+c).addClass("wntNavMenuItem").html("Street View").click(function(){m.setStreetView()});a(f).append(i)}d=document.createElement("span");
a(d).attr("id","wntNavEnd"+c).addClass("wntNavEnd").click(function(){a(b).trigger("hideControls")});a(f).append(d);a(b).bind("isStreetViewAvailable",function(a,b){p(b)});a(b).bind("isHouseViewAvailable",function(a,b){n(b)});a(b).bind("currentView",function(a,b){j(b)});a(b).bind("mapControlChanged",function(){});var p=function(b){b?a(i).removeClass("notAvailable"):a(i).addClass("notAvailable")},n=function(b){b?a(t).removeClass("notAvailable"):a(t).addClass("notAvailable")},j=function(b){"house"==b?
a(t).addClass("selected"):a(t).removeClass("selected");"street"==b?(a(l).show(),a(f).hide()):(a(l).hide(),a(f).show());"map"==b?a(g).addClass("selected"):a(g).removeClass("selected");"sat"==b?a(h).addClass("selected"):a(h).removeClass("selected");"hyb"==b?a(e).addClass("selected"):a(e).removeClass("selected")};j(this.getCurrentView());p(this.isStreetViewAvailable());n(this.isHouseViewAvailable());return this};this.mouseControlContainer=function(f){z++;c(235);a(b).bind("shiftMouseControlContainer",
function(a,b){c(b)});a(b).bind("disableMouseControls",function(){a(f).hide()});a(b).bind("enableMouseControls",function(){a(f).show()});var d=document.createElement("div");a(d).addClass("wntMouseControlExpand").click(function(){a(b).trigger("showControls")});a(f).parent().append(d);a(b).bind("hideControls",function(){a(f).animate({left:-400},800,function(){a(d).animate({left:0},400)})});a(b).bind("showControls",function(){a(d).animate({left:-71},400,function(){a(f).animate({left:0},800)})});var c=
function(c){c-=25;"poi"==b.getMapName()&&a(f).css({top:c+"px"})}};this.mouseControl=function(f){var d=this,c=z++,l=document.createElement("div");a(l).attr("id","wntMouseControlBackground"+c).addClass("wntMouseControlBackground");a(f).append(l);l=document.createElement("div");a(l).attr("id","wntMouseControlStart"+c).addClass("wntMouseControlStart");a(f).append(l);l=document.createElement("div");a(l).attr("id","wntClickDragLabel"+c).addClass("wntMouseMenuItem").css({cursor:"default",borderLeft:"0px"});
a(f).append(l);var g=document.createElement("div");a(g).attr("id","wntClickDragLabelText"+c).addClass("wntMouseControlContent").html("Click & Drag to: ");a(l).append(g);var e=document.createElement("div");a(e).attr("id","wntMouseZoomControl"+c).addClass("wntMouseMenuItem").click(function(){d.setDragZoom()});a(f).append(e);l=document.createElement("div");a(l).attr("id","wntMouseZoomText"+c).addClass("wntMouseControlContent").html("Zoom");a(e).append(l);var h=document.createElement("div");a(h).attr("id",
"wntmouseMoveControl"+c).addClass("wntMouseMenuItem").click(function(){d.setDragMove()});a(f).append(h);l=document.createElement("div");a(l).attr("id","wntMouseMoveText"+c).addClass("wntMouseControlContent").html("Move");a(h).append(l).addClass("selected");if(!a.browser.msie){l=document.createElement("span");a(l).attr("id","spacerNode"+c).addClass("wntMouseMenuSpacer").html(" ");a(f).append(l);var i=document.createElement("div");a(i).attr("id","wntMouseWheelZoom"+c).addClass("wntMouseMenuItem").click(function(){d.toggleMouseWheelZoom()});
a(f).append(i);var t=document.createElement("img");a(t).attr({id:"wntMouseWheelZoomCheckbox"+c,src:"/2_5/images/map/box_unchecked.png"}).css({height:"13px",width:"13px",marginTop:"-2px"});a(i).append(t);l=document.createElement("div");a(l).attr("id","wntMouseWheelZoomText"+c).addClass("wntMouseControlContent").html(" Mouse Wheel Zoom");a(l).css({paddingTop:"0px"});a(i).append(l)}l=document.createElement("span");a(l).attr("id","wntMouseControlEnd"+c).addClass("wntNavEnd").click(function(){a(b).trigger("hideControls")});
a(f).append(l);a(b).bind("toggleMouseControl",function(f,c,d,g){switch(c){case "mouseWheelZoom":d?(a(i).addClass("selected"),a(t).attr("src","/2_5/images/map/box_checked.png")):(a(i).removeClass("selected"),a(t).attr("src","/2_5/images/map/box_unchecked.png"));break;case "dragMove":a(h).addClass("selected");a(e).removeClass("selected");a(i).css({opacity:1,filter:"alpha(opacity=100)"});g&&a(b).trigger("mapControlChanged");break;case "dragZoom":a(e).addClass("selected"),a(h).removeClass("selected"),
a(i).css({opacity:0.4,filter:"alpha(opacity=40)"}),g&&a(b).trigger("mapControlChanged")}});return this};this.panZoomMapControl=function(f,d){var c=this,g=i(d.expandedZoom,!1),e=z++,h=function(a){return function(){c.zoomTo(a)}},qa=function(b){switch(b){case "street":a(f).hide();break;case "house":a(f).show();a(o).show();a(q).hide();a(r).show();break;default:a(o).show(),g?a(q).show():a(q).hide(),a(f).show(),a(r).hide()}t()},n=function(b){a(j).removeClass("wntNorth").removeClass("wntSouth").removeClass("wntWest").removeClass("wntEast");
switch(b){case "n":a(j).addClass("wntNorth");break;case "s":a(j).addClass("wntSouth");break;case "w":a(j).addClass("wntWest");break;case "e":a(j).addClass("wntEast")}},t=function(){c.canZoomIn()?a(A).removeClass("disabled"):a(A).addClass("disabled");c.canZoomOut()?a(s).removeClass("disabled"):a(s).addClass("disabled");for(var b=c.getMapquestMaxZoom();b>=c.getMapquestMinZoom();b--)a(q).removeClass("wntZoomLevel_"+b);a(q).addClass("wntZoomLevel_"+c.getZoomLevel())},j=document.createElement("div");a(j).attr("id",
"wntPanBackground"+e).addClass("wntPanBackground").addClass("wntNorth");a(f).append(j);var p=document.createElement("div");a(p).attr("id","wntPanUp"+e).addClass("wntPanUp").click(function(){c.panUp()});a(j).append(p);p=document.createElement("div");a(p).attr("id","wntPanDown"+e).addClass("wntPanDown").click(function(){c.panDown()});a(j).append(p);p=document.createElement("div");a(p).attr("id","wntPanLeft"+e).addClass("wntPanLeft").click(function(){c.panLeft()});a(j).append(p);p=document.createElement("div");
a(p).attr("id","wntPanRight"+e).addClass("wntPanRight").click(function(){c.panRight()});a(j).append(p);p=document.createElement("div");a(p).attr("id","wntZRContainer"+e).addClass("wntZRContainer");a(f).append(p);var k=document.createElement("div");a(k).attr("id","wntZRBackground"+e).addClass("wntZRBackground");a(p).append(k);k=document.createElement("div");a(k).attr("id","wntZRTop"+e).addClass("wntZRTop");a(p).append(k);var o=document.createElement("div");a(o).attr("id","wntZoomContainer"+e).addClass("wntZoomContainer");
a(p).append(o);var r=document.createElement("div");a(r).attr("id","wntRotateContainer"+e).addClass("wntRotateContainer");a(p).append(r);k=document.createElement("div");a(k).attr("id","wntZoomRotateBottom"+e).addClass("wntZoomRotateBottom");a(p).append(k);var A=document.createElement("div");a(A).attr("id","wntZoomIn"+e).addClass("wntZoomIn").click(function(){c.zoomIn()});a(o).append(A);var q=document.createElement("div");a(q).attr("id","wntZoomBar"+e).addClass("wntZoomBar");if(g){a(q).show();for(p=
c.getMapquestMaxZoom();p>=c.getMapquestMinZoom();p--)k=document.createElement("div"),a(k).addClass("wntZoomButton").addClass("wntZoomButton_"+p).click(h(p)),a(q).append(k)}else a(q).hide();a(o).append(q);var s=document.createElement("div");a(s).attr("id","wntZoomOut"+e).addClass("wntZoomOut").click(function(){c.zoomOut()});a(o).append(s);h=document.createElement("div");a(h).attr("id","wntRotateCW"+e).addClass("wntRotateCW").click(function(){c.rotateCW()});a(r).append(h);h=document.createElement("div");
a(h).attr("id","wntRotateCCW"+e).addClass("wntRotateCCW").click(function(){c.rotateCCW()});a(r).append(h);qa(c.getCurrentView());n(c.getMapOrientation());a(b).bind("currentView",function(a,b){qa(b)});a(b).bind("mapOrientation",function(a,b){n(b)});a(b).bind("zoomEnd",function(){t()});return this};this.bingFind=function(){var b=this;return this.find(function(d,c){b.doBingFind(d,e);var e=function(b,f){var d=[];a(f).each(function(){d.push({name:this.Name,lat:this.LatLong.Latitude,lng:this.LatLong.Longitude})});
c(d)}})};this.mapquestFind=function(b){var d=this,c=function(b,f){var c=[];a(b).find("SearchResponse").find("FeatureCollection").find("PointFeature").each(function(){c.push({name:a(this).find("Name").text(),lat:a(this).find("CenterLatLng").find("Lat").text(),lng:a(this).find("CenterLatLng").find("Lng").text()})});f(c)};return this.find(function(e,g){if(""===e)this._mapquestResults("",g);else{var h=d.getZoomLevel(),h=Math.pow(0.54,h-14)/3,i=parseInt(22*h);40>i&&(i=40);150<i&&(i=150);h='<?xml version="1.0" encoding="ISO-8859-1"?><Search Version="0"><RadiusSearchCriteria><MaxMatches>'+
i+"</MaxMatches><Radius>"+h+"</Radius><CenterLatLng><Lat>"+d.getCenter().lat+"</Lat><Lng>"+d.getCenter().lng+'</Lng></CenterLatLng></RadiusSearchCriteria>\n<CoverageName></CoverageName><DBLayerQueryCollection Count="1"><DBLayerQuery><LayerName>MQA.NTPois</LayerName><ExtraCriteria>facility = '+e+'</ExtraCriteria></DBLayerQuery></DBLayerQueryCollection><FeatureCollection Version="0" Count="0"></FeatureCollection><DTCollection Count="0"></DTCollection><Authentication Version="2"><TransactionInfo></TransactionInfo></Authentication></Search>';
a.post(b,h,function(a){c(a,g)},"xml")}})};this.find=function(b){var d={},c=[],e=!1,g={};d.add=function(a,b){e?c.push({action:"add",value:a,icon:b}):i(a,b)};d.remove=function(a){e?c.push({action:"remove",value:a}):j(a)};var i=function(c,d){e=!0;b(c,function(b){var f=h.mapIcon(d,22,24);g[c]=[];a(b).each(function(){var a=h.poi(this.lat,this.lng,f,this.name);h.addPoi(a);g[c].push(a)});k()})},j=function(b){a(g[b]).each(function(){h.removePoi(this)});k()},k=function(){if(0<c.length){var a=c.shift();"add"===
a.action?i(a.value,a.icon):j(a.value)}else e=!1};return d};this.mapIcon=function(a,b,c){var d={},e=null,g=null;d.getMapquestIcon=function(){null==e&&(e=new MQA.Icon(a,b,c));return e};d.getBingIcon=function(){null==g&&(g='<img src="'+a+'" />',getBingIcon=_getBingIcon);return g};return d};this.poi=function(a,b,c,d,e,g){var h=null,i=null,j=!1,k={},n=this,o=function(){h=new MQA.Poi({lat:a,lng:b});void 0!==c&&null!=c&&h.setIcon(c.getMapquestIcon());void 0!==d&&null!=d&&h.setRolloverContent(d);MQA.EventManager.addListener(h,
"mouseover",function(){var a=h.rolloverContent;da=a;h.rolloverContent="";j=!0;window.setTimeout(function(){h.rolloverContent=a;j&&void 0==h.rolloverWindow&&h.toggleInfoWindowRollover()},500)});MQA.EventManager.addListener(h,"mouseout",function(){j=!1;void 0!=h.rolloverWindow&&h.toggleInfoWindowRollover();""!=da&&(h.rolloverContent=da)});void 0!==e&&null!=e&&MQA.EventManager.addListener(h,"click",function(){n.houseOverClick(e,g)});return h};k.getMapquestPoi=function(){null==h&&(h=o());return h};k.getBingPoi=
function(){null==i&&(i=new VEShape(VEShapeType.Pushpin,new VELatLong(a,b)),void 0!==c&&null!=c&&i.SetCustomIcon(c.getBingIcon()),void 0!==d&&null!=d&&i.SetDescription(d));return i};return k};var za=0,ea=function(){++za;var b=a("#baseURL").val();void 0!=b&&"https:"==document.location.protocol&&b.replace("http:","https:")};this.onZoomEnd=function(){h.setMapBindings();a(b).trigger("zoomEnd")};this.onMoveEnd=function(){h.setMapBindings();a(b).trigger("moveEnd")};this.onMoveStart=function(){a(b).trigger("moveStart")};
this.onDragEnd=function(){h.setMapBindings();a(b).trigger("dragEnd")};this.houseOverClick=function(a,b){window.location.href=b};a(".wntHOItem").live("mouseup",function(){h.houseOverClick(a(this).attr("data-property-id"))});this.bestFit=function(){return g.bestFit()};this.addShape=function(a){return g.addShape(a)};this.removeAllShapes=function(){return g.removeAllShapes()};this.getZoomLevel=function(){return Number(g.getZoomLevel())-3};this.setZoomLevel=function(a){return g.setZoomLevel(Number(a)+
3)};this.getBounds=function(){return g.getBounds()};this.pixToLL=function(a){return g.pixToLL(a)};var k=document.createElement("div");a(k).attr("id","wntMtBing"+J).css("width",u).css("height",v).css("position","relative").hide();a(b).append(k);var q=document.createElement("div");a(q).attr("id","wntMtMapquest"+J).css("width",u).css("height",v).appendTo(a(b)).hide();var g={},N=g;C=B=void 0;var d=null;if("mapquest"==j){N=g=new MQA.TileMap({elt:q,zoom:Number(ha)+3,latLng:new MQA.LatLng(D,E),mtype:la,
bestFitMargin:0,zoomOnDoubleClick:!0});U&&MQA.withModule("insetmapcontrol",function(){N.addControl(new MQA.InsetMapControl({size:{width:150,height:125},zoom:3,mapType:"map",minimized:!1}),new MQA.MapCornerPlacement(MQA.MapCorner.BOTTOM_RIGHT))});(!Z||"poiMiniMap"==n)&&g._unwireDOMEvents();if("poiMiniMap"!=n){var ra=0,ta=0,va=0,wa=0;g.getSize();g.getSize();var sa=parseInt(a(b).position().left),ua=parseInt(a(b).position().top),y=document.createElement("div");a(y).attr("id","blockDiv").addClass("wntTmpBlockDiv");
a(q).append(y);var w=document.createElement("div");a(w).attr("id","cursorCoverDiv").addClass("wntCursorCoverDiv");a(q).append(w);a(w).bind("mousedown",function(a){a.preventDefault()});a(q).mousedown(function(a){"zoom"==s&&!L&&h._dragZoomMouseDown(a)});a(q).mouseup(function(a){"zoom"==s&&!L&&h._dragZoomMouseUp(a)});a(q).mousemove(function(a){"zoom"==s&&!L&&h._dragZoomMouseMove(a)})}MQA.EventManager.addListener(g,"zoomend",this.onZoomEnd);MQA.EventManager.addListener(g,"moveend",this.onMoveEnd);MQA.EventManager.addListener(g,
"movestart",this.onMoveStart);MQA.EventManager.addListener(g,"dragend",this.onDragEnd);P&&MQA.withModule("mousewheel",function(){N.enableMouseWheelZoom()});ka&&MQA.withModule("viewoptions",function(){void 0==B&&(B=new MQA.ViewOptions,N.addControl(B))});ja&&MQA.withModule("largezoom",function(){void 0==C&&(C=new MQA.LargeZoom,N.addControl(C,new MQA.MapCornerPlacement(MQA.MapCorner.TOP_LEFT,new MQA.Size(5,5))))})}"undefined"!=typeof bingLibraryLoaded&&(bingLibraryLoaded&&K)&&(a(k).show(),d=new VEMap(k.id),
d.LoadMap(new VELatLong(D,E),ia,VEMapStyle.Birdseye),d.HideDashboard(),d.SetCenter(new VELatLong(D,E)),d.AttachEvent("onkeydown",function(a){return 40<a.keyCode||37>a.keyCode}),d.AttachEvent("onkeyup",function(a){return 40<a.keyCode||37>a.keyCode}),d.AttachEvent("onkeypress",function(a){return 40<a.keyCode||37>a.keyCode}),d.AttachEvent("onendzoom",function(){h.onZoomEnd()}),d.AttachEvent("onobliquechange",function(){h._orientationChanged()}),window.setInterval(function(){h._houseViewClientHandler()},
500),-1!=navigator.userAgent.indexOf("Firefox/3.5")&&k.addEventListener("DOMMouseScroll",function(a){a.stopPropagation();a.preventDefault();return a.cancelBubble=!1},!1),a(k).hide());var r=null,J=null;O&&(Z=new google.maps.LatLng(D,E),J=new google.maps.StreetViewService,J.getPanoramaByLocation(Z,50,function(a){h._streetViewClientHandler(a)}));M=!1;this.setMapView();A=a("[data-wnt-map-name="+n+"][data-wnt-map-bind=centerLat]");V=a("[data-wnt-map-name="+n+"][data-wnt-map-bind=centerLng]");W=a("[data-wnt-map-name="+
n+"][data-wnt-map-bind=mapType]");X=a("[data-wnt-map-name="+n+"][data-wnt-map-bind=lrLat]");G=a("[data-wnt-map-name="+n+"][data-wnt-map-bind=lrLng]");H=a("[data-wnt-map-name="+n+"][data-wnt-map-bind=ulLat]");x=a("[data-wnt-map-name="+n+"][data-wnt-map-bind=ulLng]");Y=a("[data-wnt-map-name="+n+"][data-wnt-map-bind=zoom]");F=a("[data-wnt-map-name="+n+"][data-wnt-map-bind=mapViewType]");fa=a("[data-wnt-map-name="+n+"][data-wnt-map-bind=mapDragType]");ga=a("[data-wnt-map-name="+n+"][data-wnt-map-bind=allowMouseWheel]");
this.setMapBindings();a(b).data("map",this);xa&&(this.zoomToRect(R.tlLat,R.tlLng,R.brLat,R.brLng),""!=oa&&this.zoomTo(oa));switch(la){case "map":this.setMapView();break;case "hyb":this.setHybridView();break;case "sat":this.setSatView();break;case "house":window.setTimeout(function(){h.setHouseView()},2E3);break;case "street":window.setTimeout(function(){h.setStreetView()},2E3)}ya&&this.addPoi(this.poi(ca.lat,ca.lng,this.mapIcon(ca.icon,21,23)));this.setupMouseControls();a(b).bind("currentView mapControlChanged",
function(){var b=a("#baseURL").val();b!=void 0&&document.location.protocol=="https:"&&b.replace("http:","https:");if(n!="poiMiniMap"){var b=h.getCurrentView(),d=h.getDragType(),c=h.getAllowMouseWheel();F.val(b);fa.val(d);ga.val(c);ea()}});void 0!==n&&"poiMiniMap"!=n&&("move"==h.getDragType()?h.setDragMove(!1):h.setDragZoom(!1));a("[data-wnt-resetMap=]").click(function(){h.reset()});a(h).bind("moveEnd zoomEnd",ea);ea();return this},i=function(a,e,i){a=void 0===a?void 0!==e?e:"":a;void 0===i&&void 0!==
e&&(i=typeof e);if(void 0!==i)switch(i){case "boolean":if("boolean"!=typeof a)switch(a){case 1:case "true":case "yes":case "y":a=!0;break;default:a=!1}break;case "number":"number"!=typeof a&&(a=new Number(a))}return a};z=T=0;var x={init:function(b){return this.each(function(){(new F).createMap(this);var e=b.houseoverData||[],i;for(i in e)x.addHouseOver.call(a(this),[e[i].lat,e[i].lng,e[i].propertyId,e[i].propertyUrl,e[i].content,b.houseoverIcon,b.mapId]);a("#"+b.mapId).data("map").bestFit()})},addHouseOver:function(b){return this.each(function(){var e=
b[0],i=b[1],x=b[2],z=b[3],F=b[4],G=b[5],H=a("#"+b[6]).data("map"),G=H.mapIcon(G,30,30),e=H.poi(e,i,G,F,x,z);H.addPoi(e)})}};a.fn.wolfnetMapTracks=function(b){if(x[b])return x[b].apply(this,Array.prototype.slice.call(arguments,1));if("object"===typeof b||!b)return x.init.apply(this,arguments);a.error("Method "+b+" does not exist on jQuery.wolfnetMapTracks")}})(jQuery);
