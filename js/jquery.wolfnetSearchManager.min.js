"function"!==typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});
"undefined"!=typeof jQuery&&function(c){var j={apiUrl:"",apiGetSuffix:"-get",apiPostSuffix:"-save",apiDeleteSuffix:"-delete",loaderUri:"img/loader.gif",loaderClass:"wolfnet_loaderImage",refreshedEvent:"wolfnetDataRefreshed",savedEvent:"wolfnetSearchSaved",deletedEvent:"wolfnetSearchDelete",itemIdPrefix:"savedsearch_"},i={init:function(e){return this.each(function(){var a=c(this),b={option:c.extend(j,e),savedSearches:[],loading:false,saving:false,deleting:false};b.saveForm=typeof b.option.saveForm==
"jQuery"?b.option.saveForm:c(b.option.saveForm);a.data("wolfnetSearchManager",b);a.wolfnetSearchManager("_createLoaderImage");a.wolfnetSearchManager("refresh");var f=b.saveForm.find("button:first"),d=b.saveForm.find("input:first"),g=function(){if(d.length!=0){d.trigger("submit");var b=d.val().trim()}else b="";var c=typeof WNTWP!="undefined"?WNTWP.returnSearchParams():{};a.wolfnetSearchManager("save",b,c)};f.click(g);d.keypress(function(a){a.keyCode==13&&g()});a.bind(b.option.refreshedEvent,function(){c(this).wolfnetSearchManager("_buildTable")});
a.bind(b.option.savedEvent,function(){if(d.length!=0){d.val("");d.trigger("blur")}c(this).data("wolfnetSearchManager",c.extend(b,{saving:false}))});a.bind(b.option.deletedEvent,function(){a.data("wolfnetSearchManager",c.extend(b,{deleting:false}))})})},refresh:function(){return this.each(function(){c(this).wolfnetSearchManager("_loadData")})},save:function(e,a){if(typeof e!="string"||typeof a!="object"){c.error("To perform save on jQuery.wolfnetSearchManager valid description and criteria arguments must be passed.");
return this}if(e.trim()==""){alert("You must specify a description to save your search.");return this}for(var b in a)a[b]=decodeURIComponent(a[b]);return this.each(function(){var b=c(this),d=b.data("wolfnetSearchManager"),g=d.option.apiUrl+d.option.apiPostSuffix;d.loading||d.saving||d.deleting?alert("Cannot save, please wait until the data has updated."):c.ajax({url:g,dataType:"json",type:"POST",data:{post_title:e,custom_fields:a},beforeSend:function(){d.loaderImage.show();b.data("wolfnetSearchManager",
c.extend(d,{saving:true}))},success:function(a){d.savedSearches=a;b.data("wolfnetSearchManager",d);b.trigger(d.option.savedEvent);b.trigger(d.option.refreshedEvent)},complete:function(){d.loaderImage.hide()}})})},"delete":function(e){return this.each(function(){var a=c(this),b=a.data("wolfnetSearchManager"),f=b.option.apiUrl+b.option.apiDeleteSuffix;b.loading||b.saving||b.deleting?alert("Cannot delete, please wait until the data has updated."):c.ajax({url:f,dataType:"json",type:"GET",data:{ID:e},
beforeSend:function(){b.loaderImage.show();a.data("wolfnetSearchManager",c.extend(b,{deleting:true}))},success:function(c){b.savedSearches=c;a.data("wolfnetSearchManager",b);a.trigger(b.option.deletedEvent);a.trigger(b.option.refreshedEvent)},complete:function(){b.loaderImage.hide()}})})},_createLoaderImage:function(){return this.each(function(){var e=c(this),a=e.data("wolfnetSearchManager"),b=a.option.loaderUri,f=a.option.loaderClass;a.loaderImage=e.find("div."+f+":first");if(a.loaderImage.length==
0){a.loaderImage=c("<div/>");a.loaderImage.append(c('<img src="'+b+'" />'));a.loaderImage.addClass(f);a.loaderImage.hide();a.loaderImage.appendTo(e)}e.data("wolfnetSearchManager",a)})},_loadData:function(){return this.each(function(){var e=c(this),a=e.data("wolfnetSearchManager");c.ajax({url:a.option.apiUrl+a.option.apiGetSuffix,dataType:"json",type:"GET",beforeSend:function(){a.loaderImage.show();e.data("wolfnetSearchManager",c.extend(a,{loading:true}))},success:function(b){a.savedSearches=b;e.data("wolfnetSearchManager",
a);e.trigger(a.option.refreshedEvent)},complete:function(){e.data("wolfnetSearchManager",c.extend(a,{loading:false}));a.loaderImage.hide()}})})},_buildTable:function(){return this.each(function(){var e=c(this),a=e.data("wolfnetSearchManager"),b=a.savedSearches,f,d,g=e.find("tbody:first");g.children().remove();for(var h in b){var i="post.php?action=edit&post="+b[h].ID;f=c("<tr/>");f.attr("id",a.option.itemIdPrefix+b[h].ID);f.addClass("savedsearch");f.appendTo(g);h%2==0&&f.addClass("alternate");d=c("<td/>");
d.html(b[h].post_title+' (<a href="'+i+'">View Criteria</a>)');d.appendTo(f);d=c("<td/>");d.html(b[h].post_date);d.appendTo(f);d=c("<td/>");d.appendTo(f);f=c("<button/>");f.addClass("button-secondary");f.attr("wnt:search",b[h].ID);f.html("Delete");f.appendTo(d);f.click(function(){e.wolfnetSearchManager("delete",c(this).attr("wnt:search"))})}})}};c.fn.wolfnetSearchManager=function(e){if(i[e])return i[e].apply(this,Array.prototype.slice.call(arguments,1));if(typeof e==="object"||!e)return i.init.apply(this,
arguments);c.error("Method "+e+" does not exist on jQuery.wolfnetSearchManager")}}(jQuery);
